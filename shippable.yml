language: node_js

node_js:
  - '0.11.14'

addons:
  firefox: '29.0'

services:
  - selenium

before_install:
  - 'npm install -g gulp'
  - 'npm install -g bower'
  - 'npm install -g protractor'
  - 'npm install jasmine-reporters@1.0.0'
  - 'npm install'
  - 'bower install'

env:
  global:
    - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage

before_script: 
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
  - cp config/development.json.example config/development.json
  - cp config/config.js.example config/config.js
  - 'export DISPLAY=:99.0'
  - '/etc/init.d/xvfb start'

script:
  - gulp build
  - 'gulp server &'
  - gulp test:unit
  - gulp test:e2e

after_script:
  - '/etc/init.d/xvfb stop'

branches:
  only:
    - master

notifications:
  email:
    recipients:
      - kamil@briisk.co
